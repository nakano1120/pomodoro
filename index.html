<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
    body{
        text-align:center;
        background-color:#eeeeee;
    }
    #nowtime{
        font-size:300%;
    }
    #nowstation{
        color:#00B2E5;
        padding:10px;
        background-color:#ffffff;
        font-size:300%;
    }
    table{
        
        margin-left:auto;
        margin-right:auto;
    }
    td{
        font-size:150%;
    }
    .blue{
        border:8px solid #00B2E5;
        width:50px;
    }
    #study{
        position:absolute;
        top:0;
        left:0;
        color:#F00;
        font-size:300%;
    }
    </style>
</head>
<body>
    <div id="study">勉強</div>
    <input type="button" value="1駅休憩" onclick="coffee()">
    <h1 id="nowtime">00:00:00</h1>
    <h2>区間：<span id="sectiontime">00:00:00</span></h2>
    <h2><span id="next">次は</span>　<span id="nowstation">大宮</span><h2>
    <table>
        <tr>
            <td id="relax1"></td><td id="no1">大宮</td><td class="blue" id="time1">0</td>
        </tr>
        <tr>
            <td id="relax2"></td><td id="no2">さいたま新都心</td><td class="blue" id="time2">3</td>
        </tr>  
        <tr>
            <td id="relax3"></td><td id="no3">与野</td><td class="blue" id="time3">5</td>
        </tr>   
        <tr>
            <td id="relax4"></td><td id="no4">北浦和</td><td class="blue" id="time4">7</td>
        </tr>  
        <tr>
            <td id="relax5"></td><td id="no5">浦和</td><td class="blue" id="time5">10</td>
        </tr> 
    </table>
    <select id="departure" onchange="changestation()">
        <option value="0">大宮</option>
        <option value="5">南浦和</option>
        <option value="9">赤羽</option>
        <option value="10">東十条</option>
        <option value="17">上野</option>
        <option value="21">東京</option>
        <option value="26">品川</option>
        <option value="29">蒲田</option>
        <option value="31">鶴見</option>
        <option value="34">横浜</option>
        <option value="35">桜木町</option>
        <option value="40">磯子</option>
        <option value="45">大船</option>
    </select>
    始発
    <select id="arrival" onchange="changestation()">
        <option value="0">大宮</option>
        <option value="5">南浦和</option>
        <option value="9">赤羽</option>
        <option value="10">東十条</option>
        <option value="17">上野</option>
        <option value="21">東京</option>
        <option value="26">品川</option>
        <option value="29">蒲田</option>
        <option value="31">鶴見</option>
        <option value="34">横浜</option>
        <option value="35">桜木町</option>
        <option value="40">磯子</option>
        <option value="45">大船</option>
    </select>
    行き<br>
    <br>
    推定所要時間　<span id="maybetime">0</span>　分
    <input type="button" id="startbutton" value="出発" onclick="timer()">
    <script>
    const time=[0,3,5,7,10,12,16,18,21,25,28,31,33,36,38,40,42,44,46,48,50,52,54,56,58,61,64,67,70,74,77,81,85,88,91,94,96,98,100,103,106,109,112,115,118,122]
    const between=[]
    const station=["大宮","さいたま新都心","与野","北浦和","浦和","南浦和","蕨","西川口","川口","赤羽","東十条","王子","上中里","田端","西日暮里","日暮里","鶯谷","上野","御徒町","秋葉原","神田","東京","有楽町","新橋","浜松町","田町","品川","大井町","大森","蒲田","川崎","鶴見","新子安","東神奈川","横浜","桜木町","関内","石川町","山手","根岸","磯子","新杉田","洋光台","港南台","本郷台","大船"]
    let alltime=0
    let departuretime=0
    let arrivaltime=0
    let nowstation=0
    let section=""
    let stationtimer
    let coffeecount=0
    const dep = document.getElementById('departure');
    const arr = document.getElementById('arrival');
    const stu = document.getElementById('studytime');
    const cof = document.getElementById('coffeetime');
    function timer(){
        const depindex = dep.selectedIndex;
        const arrindex = arr.selectedIndex;
        const depvalue = dep.options[depindex].value;
        const arrvalue = arr.options[arrindex].value;
        const studysection = 
        start = new Date();
        departuretime = time[depvalue];
        arrivaltime = time[arrvalue];
        console.log(departuretime + " " + arrivaltime)
        alltime=arrivaltime-departuretime;
        nowstation=parseInt(depvalue);
        if(alltime<1){
            alert("出発地点、到着地点が不正です")
            return
        }
        alert("出発します。")
        document.getElementById("startbutton").disabled = true;
        document.getElementById("departure").disabled = true;
        document.getElementById("arrival").disabled = true;
        stationtimer = setInterval(timermain, 100);
    }
    function timermain(){
        let now = new Date();
        let diftime = (now.getTime() - start.getTime());
        let point = Math.floor(diftime / 100);
        let point2 = Math.floor(point % 10);
        let point3 = parseInt(9)-Math.floor(point % 10);
        let sec = Math.floor(diftime / 1000);
        let secsec = Math.floor(sec % 60);
        let sec3 = parseInt(60)-Math.floor(sec % 60);
        let min = Math.floor(sec / 60);
        let min3 = parseInt(time[nowstation+0]-time[nowstation-1])-Math.floor(sec / 60);
        let hour = Math.floor(min / 60);
        secsec = addZero(secsec);
        sec3 = addZero(sec3)
        min2 = addZero(min);
        min3 = addZero(min3);
        hour = addZero(hour);
        if(min+departuretime>=time[nowstation]){
            nowstation+=1
            changenext();
            if(coffeecount==1){
                coffeecount=0;
                document.getElementById("study").innerHTML="勉強"
                document.getElementById("study").style.color="#ff0000"
            }
        }
        if((min+departuretime)+1>=time[nowstation] && secsec>30){
            document.getElementById("next").innerHTML="まもなく"
        }else{
            document.getElementById("next").innerHTML="次は"
        }
        let numbering=47-nowstation
        numbering=addZero(numbering);
        section=station[nowstation]+"(JK-"+numbering+")"
        document.getElementById("nowstation").innerHTML=section;
        document.getElementById("nowtime").innerHTML=""+hour+":"+min2+":"+secsec+"."+point2;
        document.getElementById("sectiontime").innerHTML=""+hour+":"+min3+":"+sec3+"."+point3;
        if(min>=alltime){
            clearInterval(stationtimer);
        }
    }
    var addZero = function (value) {
        if (value < 10) {
            value = '0' + value;
        }
        return value;
    }
    function changestation(){
        const depindex = dep.selectedIndex;
        const arrindex = arr.selectedIndex;
        const depvalue = dep.options[depindex].value;
        const arrvalue = arr.options[arrindex].value;
        departuretime = time[depvalue];
        arrivaltime = time[arrvalue];
        let maybetime=arrivaltime-departuretime
        document.getElementById("maybetime").innerHTML=maybetime
    }
    function changenext(){
        document.getElementById("no1").innerHTML=station[nowstation+0]
        document.getElementById("no2").innerHTML=station[nowstation+1]
        document.getElementById("no3").innerHTML=station[nowstation+2]
        document.getElementById("no4").innerHTML=station[nowstation+3]
        document.getElementById("no5").innerHTML=station[nowstation+4]
        document.getElementById("time1").innerHTML=time[nowstation+0]-time[nowstation-1]
        document.getElementById("time2").innerHTML=time[nowstation+1]-time[nowstation-1]
        document.getElementById("time3").innerHTML=time[nowstation+2]-time[nowstation-1]
        document.getElementById("time4").innerHTML=time[nowstation+3]-time[nowstation-1]
        document.getElementById("time5").innerHTML=time[nowstation+4]-time[nowstation-1]
    }
    function coffee(){
        coffeecount=1;
        document.getElementById("study").innerHTML="休憩"
        document.getElementById("study").style.color="#0000ff"
    }
    </script>
</body>
</html>